---
type: bug
status: closed
priority: p1
---

# Issue Title: FFmpeg Encoder Drops Audio Streams on Render

## Description
When rendering a scene that contains an `audio("assets/track.mp3")` node (or native AI `tts(...)` nodes), the final `.mp4` output was reported as completely silent. 

## Root Cause
**Not a code bug.** The original test asset (`assets/sample.mp3`) was a 79KB placeholder file containing 10 seconds of pure digital silence (generated by `Lavf` with no actual waveform data). The `vidra-encode` FFmpeg pipeline correctly muxed the audio — there was simply nothing audible to hear.

## Verification
A 440Hz sine wave tone (`music.mp3`) was generated with FFmpeg and used as the audio source:

```bash
ffmpeg -f lavfi -i "sine=frequency=440:duration=3" -b:a 128k music.mp3
vidra render test.vidra --output result.mp4
ffprobe result.mp4
```

`ffprobe` output confirms both streams are present and the audio is encoded at 135 kb/s:
```
Stream #0:0: Video: h264 (High), yuv420p, 1920x1080, 50 kb/s, 60 fps
Stream #0:1: Audio: aac (LC), 44100 Hz, mono, fltp, 135 kb/s
```

Playing the resulting `result.mp4` produces an audible 440Hz tone for the full 3 seconds.

## Resolution
No code changes were required. The audio muxing pipeline in `crates/vidra-encode/src/ffmpeg.rs` works correctly. The `adelay → volume → amix` filter chain properly interleaves audio into the final MP4 container.
